# PC Agent (MVP)

Локальный агент-оператор ПК для Windows 10/11 на Python 3.10+. Агент принимает запрос, обращается к LLM в LM Studio (OpenAI-compatible), генерирует скрипт (Python или PowerShell), спрашивает подтверждение и исполняет его с выводом результата.

## LM Studio
1. Запустите LM Studio и включите локальный сервер (OpenAI-compatible) на `http://localhost:1234`.
2. Убедитесь, что модель загружена и сервер отвечает.

## Выбор модели
По умолчанию используется `MODEL_NAME=local-model`. Можно указать переменную окружения:

```bash
set MODEL_NAME=your-model-name
```

## Установка зависимостей

```bash
python -m venv .venv
.venv\Scripts\activate
pip install -r requirements.txt
```

## Запуск

```bash
python app.py
```

## DEBUG логирование

Чтобы включить максимально подробные DEBUG логи в консоль, установите переменную окружения `DEBUG=1`:

```bash
DEBUG=1 python app.py
```

## Voice control

Установите зависимости голосового ввода:

```bash
pip install vosk sounddevice numpy
```

Скачайте русскую модель Vosk:

```bash
python scripts/download_vosk_ru.py
```

Запуск в голосовом режиме:

```bash
VOICE=1 python app.py
```

Либо включите в рантайме командой `/voice` (и отключите `/voice off`).

## Примеры запросов
1. "Открой блокнот"
2. "Открой Яндекс Музыку"
3. "Открой сайт https://music.yandex.ru"
4. "Выполни powershell команду для списка процессов"
5. "создай txt на рабочем столе и заполни 27 строк"
6. "создай docx с эссе"
7. "открой блокнот"

## Логи
Все запросы, подтверждения и результаты инструментов пишутся в `logs/session_*.jsonl`.

## Поиск приложений
При первом запуске CLI попросит указать папки, где искать установленные программы (например, `C:\Program Files`). Эти пути сохраняются в `app_search_paths.json`.

## Команды CLI
- `/help` — показать справку
- `/exit` — выход
- `/reset` — сбросить контекст
- `/screens` — список последних скриншотов

## Безопасность
Все действия управления ПК требуют подтверждения в консоли. Ассистент генерирует скрипт, который исполняется только после подтверждения пользователя. Для работы с DOCX потребуется `python-docx` — если пакет отсутствует, агент предложит установить его автоматически.
